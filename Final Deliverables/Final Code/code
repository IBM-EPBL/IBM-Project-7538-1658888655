{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2022-10-04T14:13:49.930347Z","iopub.status.busy":"2022-10-04T14:13:49.92918Z","iopub.status.idle":"2022-10-04T14:13:50.575883Z","shell.execute_reply":"2022-10-04T14:13:50.574742Z","shell.execute_reply.started":"2022-10-04T14:13:49.930284Z"}},"outputs":[],"source":["\n","import numpy as np \n","import pandas as pd \n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:15:02.088279Z","iopub.status.busy":"2022-10-04T14:15:02.086831Z","iopub.status.idle":"2022-10-04T14:15:02.125021Z","shell.execute_reply":"2022-10-04T14:15:02.123862Z","shell.execute_reply.started":"2022-10-04T14:15:02.088233Z"},"trusted":true},"outputs":[],"source":["employee = pd.read_csv(\"../input/ibm-hr-analytics-attrition-dataset/WA_Fn-UseC_-HR-Employee-Attrition.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:15:06.366399Z","iopub.status.busy":"2022-10-04T14:15:06.365873Z","iopub.status.idle":"2022-10-04T14:15:06.412647Z","shell.execute_reply":"2022-10-04T14:15:06.411429Z","shell.execute_reply.started":"2022-10-04T14:15:06.36634Z"},"trusted":true},"outputs":[],"source":["employee"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:15:28.361326Z","iopub.status.busy":"2022-10-04T14:15:28.360813Z","iopub.status.idle":"2022-10-04T14:15:28.386755Z","shell.execute_reply":"2022-10-04T14:15:28.385397Z","shell.execute_reply.started":"2022-10-04T14:15:28.361289Z"},"trusted":true},"outputs":[],"source":["employee.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:15:43.224266Z","iopub.status.busy":"2022-10-04T14:15:43.222924Z","iopub.status.idle":"2022-10-04T14:15:43.24645Z","shell.execute_reply":"2022-10-04T14:15:43.245534Z","shell.execute_reply.started":"2022-10-04T14:15:43.224219Z"},"trusted":true},"outputs":[],"source":["employee.tail()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:16:01.679569Z","iopub.status.busy":"2022-10-04T14:16:01.67902Z","iopub.status.idle":"2022-10-04T14:16:01.776194Z","shell.execute_reply":"2022-10-04T14:16:01.77482Z","shell.execute_reply.started":"2022-10-04T14:16:01.679527Z"},"trusted":true},"outputs":[],"source":["employee.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:16:19.46963Z","iopub.status.busy":"2022-10-04T14:16:19.469171Z","iopub.status.idle":"2022-10-04T14:16:19.492623Z","shell.execute_reply":"2022-10-04T14:16:19.491126Z","shell.execute_reply.started":"2022-10-04T14:16:19.469593Z"},"trusted":true},"outputs":[],"source":["employee.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:18:50.107143Z","iopub.status.busy":"2022-10-04T14:18:50.106729Z","iopub.status.idle":"2022-10-04T14:18:50.120708Z","shell.execute_reply":"2022-10-04T14:18:50.119428Z","shell.execute_reply.started":"2022-10-04T14:18:50.107112Z"},"trusted":true},"outputs":[],"source":["employee['Attrition'] = employee['Attrition'].apply(lambda x:1 if x == 'Yes' else 0)\n","employee['OverTime'] = employee['OverTime'].apply(lambda x:1 if x == 'Y' else 0)\n","employee['Over18'] = employee['Over18'].apply(lambda x:1 if x == 'Yes' else 0)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:19:23.407042Z","iopub.status.busy":"2022-10-04T14:19:23.406569Z","iopub.status.idle":"2022-10-04T14:19:23.432066Z","shell.execute_reply":"2022-10-04T14:19:23.430613Z","shell.execute_reply.started":"2022-10-04T14:19:23.407008Z"},"trusted":true},"outputs":[],"source":["employee.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:19:41.167023Z","iopub.status.busy":"2022-10-04T14:19:41.16654Z","iopub.status.idle":"2022-10-04T14:19:41.1802Z","shell.execute_reply":"2022-10-04T14:19:41.178776Z","shell.execute_reply.started":"2022-10-04T14:19:41.16699Z"},"trusted":true},"outputs":[],"source":["employee.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:20:04.029879Z","iopub.status.busy":"2022-10-04T14:20:04.029443Z","iopub.status.idle":"2022-10-04T14:20:09.840116Z","shell.execute_reply":"2022-10-04T14:20:09.838797Z","shell.execute_reply.started":"2022-10-04T14:20:04.029848Z"},"trusted":true},"outputs":[],"source":["employee.hist(bins = 30, figsize = (20,20), color = 'r')"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:21:44.72069Z","iopub.status.busy":"2022-10-04T14:21:44.720194Z","iopub.status.idle":"2022-10-04T14:21:44.729182Z","shell.execute_reply":"2022-10-04T14:21:44.727779Z","shell.execute_reply.started":"2022-10-04T14:21:44.720651Z"},"trusted":true},"outputs":[],"source":["employee.drop(['EmployeeCount','StandardHours','Over18','EmployeeNumber'], axis = 1, inplace = True)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:27:03.541962Z","iopub.status.busy":"2022-10-04T14:27:03.541456Z","iopub.status.idle":"2022-10-04T14:27:03.568951Z","shell.execute_reply":"2022-10-04T14:27:03.567835Z","shell.execute_reply.started":"2022-10-04T14:27:03.541915Z"},"trusted":true},"outputs":[],"source":["employee.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:27:24.702727Z","iopub.status.busy":"2022-10-04T14:27:24.701154Z","iopub.status.idle":"2022-10-04T14:27:24.712115Z","shell.execute_reply":"2022-10-04T14:27:24.710691Z","shell.execute_reply.started":"2022-10-04T14:27:24.702663Z"},"trusted":true},"outputs":[],"source":["left = employee[employee['Attrition'] == 1]\n","stay = employee[employee['Attrition'] == 0]"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:27:39.73667Z","iopub.status.busy":"2022-10-04T14:27:39.736185Z","iopub.status.idle":"2022-10-04T14:27:39.745285Z","shell.execute_reply":"2022-10-04T14:27:39.743976Z","shell.execute_reply.started":"2022-10-04T14:27:39.736635Z"},"trusted":true},"outputs":[],"source":["print('Total Employees = ', len(employee))\n","print('Number of Employees Who Left = ', len(left))\n","print('% of Employees Who Left = ', 1*len(left)/len(employee)*100,'%')\n","\n","print('Number of Employees Who Stay = ', len(stay))\n","print('% of Employees Who Stay = ', 1*len(stay)/len(employee)*100,'%')"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:27:53.808123Z","iopub.status.busy":"2022-10-04T14:27:53.807661Z","iopub.status.idle":"2022-10-04T14:27:53.890685Z","shell.execute_reply":"2022-10-04T14:27:53.889358Z","shell.execute_reply.started":"2022-10-04T14:27:53.808086Z"},"trusted":true},"outputs":[],"source":["left.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:28:09.654122Z","iopub.status.busy":"2022-10-04T14:28:09.653643Z","iopub.status.idle":"2022-10-04T14:28:09.738905Z","shell.execute_reply":"2022-10-04T14:28:09.737632Z","shell.execute_reply.started":"2022-10-04T14:28:09.65408Z"},"trusted":true},"outputs":[],"source":["stay.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:28:45.503216Z","iopub.status.busy":"2022-10-04T14:28:45.502777Z","iopub.status.idle":"2022-10-04T14:28:49.112745Z","shell.execute_reply":"2022-10-04T14:28:49.111371Z","shell.execute_reply.started":"2022-10-04T14:28:45.503183Z"},"trusted":true},"outputs":[],"source":["correlations = employee.corr()\n","f, ax = plt.subplots(figsize = (20,20))\n","sns.heatmap(correlations, annot = True)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:29:16.747726Z","iopub.status.busy":"2022-10-04T14:29:16.747244Z","iopub.status.idle":"2022-10-04T14:29:16.753705Z","shell.execute_reply":"2022-10-04T14:29:16.75241Z","shell.execute_reply.started":"2022-10-04T14:29:16.747688Z"},"trusted":true},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:29:53.331235Z","iopub.status.busy":"2022-10-04T14:29:53.33074Z","iopub.status.idle":"2022-10-04T14:29:54.114367Z","shell.execute_reply":"2022-10-04T14:29:54.113027Z","shell.execute_reply.started":"2022-10-04T14:29:53.331193Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [25,12])\n","sns.countplot(x = 'Age', hue = 'Attrition', data = employee)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:30:40.748588Z","iopub.status.busy":"2022-10-04T14:30:40.748065Z","iopub.status.idle":"2022-10-04T14:30:41.513401Z","shell.execute_reply":"2022-10-04T14:30:41.511789Z","shell.execute_reply.started":"2022-10-04T14:30:40.748547Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [20,20])\n","\n","plt.subplot(411)\n","sns.countplot(x = 'JobRole', hue = 'Attrition', data = employee)\n","\n","plt.subplot(412)\n","sns.countplot(x = 'MaritalStatus', hue = 'Attrition', data = employee)\n","\n","plt.subplot(413)\n","sns.countplot(x = 'JobInvolvement', hue = 'Attrition', data = employee)\n","\n","plt.subplot(413)\n","sns.countplot(x = 'JobLevel', hue = 'Attrition', data = employee)"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:31:28.525447Z","iopub.status.busy":"2022-10-04T14:31:28.524032Z","iopub.status.idle":"2022-10-04T14:31:28.812579Z","shell.execute_reply":"2022-10-04T14:31:28.811254Z","shell.execute_reply.started":"2022-10-04T14:31:28.525395Z"},"trusted":true},"outputs":[],"source":["\n","\n","plt.figure(figsize = [15,10])\n","sns.kdeplot(left['DistanceFromHome'], label = 'Employee who left', shade = True, color = 'r')\n","sns.kdeplot(stay['DistanceFromHome'], label = 'Employee who stay', shade = True, color = 'b')\n","\n","plt.xlabel('Distance from Home')"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:31:46.456757Z","iopub.status.busy":"2022-10-04T14:31:46.456299Z","iopub.status.idle":"2022-10-04T14:31:46.76308Z","shell.execute_reply":"2022-10-04T14:31:46.761867Z","shell.execute_reply.started":"2022-10-04T14:31:46.456723Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [15,10])\n","sns.kdeplot(left['TotalWorkingYears'], label = 'Employee who left', shade = True, color = 'r')\n","sns.kdeplot(stay['TotalWorkingYears'], label = 'Employee who stay', shade = True, color = 'b')\n","\n","plt.xlabel('Total Working Years')"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:32:02.507885Z","iopub.status.busy":"2022-10-04T14:32:02.507418Z","iopub.status.idle":"2022-10-04T14:32:02.818969Z","shell.execute_reply":"2022-10-04T14:32:02.817715Z","shell.execute_reply.started":"2022-10-04T14:32:02.507847Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [15,10])\n","sns.kdeplot(left['YearsWithCurrManager'], label = 'Employee who left', shade = True, color = 'r')\n","sns.kdeplot(stay['YearsWithCurrManager'], label = 'Employee who stay', shade = True, color = 'b')\n","\n","plt.xlabel('Years With Current Manager')"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:32:19.955869Z","iopub.status.busy":"2022-10-04T14:32:19.95541Z","iopub.status.idle":"2022-10-04T14:32:20.209705Z","shell.execute_reply":"2022-10-04T14:32:20.208456Z","shell.execute_reply.started":"2022-10-04T14:32:19.955834Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [10,15])\n","sns.boxplot(x = employee['Gender'], y = employee['MonthlyIncome'])"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:32:40.44009Z","iopub.status.busy":"2022-10-04T14:32:40.439674Z","iopub.status.idle":"2022-10-04T14:32:40.99475Z","shell.execute_reply":"2022-10-04T14:32:40.993782Z","shell.execute_reply.started":"2022-10-04T14:32:40.44006Z"},"trusted":true},"outputs":[],"source":["plt.figure(figsize = [10,15])\n","sns.barplot(x = employee['MonthlyIncome'] , y = employee['JobRole'])"]},{"cell_type":"markdown","metadata":{},"source":["# **Training and Testing Dataset**"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:33:18.084566Z","iopub.status.busy":"2022-10-04T14:33:18.084099Z","iopub.status.idle":"2022-10-04T14:33:18.110081Z","shell.execute_reply":"2022-10-04T14:33:18.108676Z","shell.execute_reply.started":"2022-10-04T14:33:18.084531Z"},"trusted":true},"outputs":[],"source":["employee.head(2)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:33:41.359404Z","iopub.status.busy":"2022-10-04T14:33:41.35886Z","iopub.status.idle":"2022-10-04T14:33:41.382225Z","shell.execute_reply":"2022-10-04T14:33:41.380544Z","shell.execute_reply.started":"2022-10-04T14:33:41.359362Z"},"trusted":true},"outputs":[],"source":["X_cat = employee[['BusinessTravel','Department','EducationField','Gender','JobRole','MaritalStatus']]\n","X_cat"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:34:08.574696Z","iopub.status.busy":"2022-10-04T14:34:08.574176Z","iopub.status.idle":"2022-10-04T14:34:08.677668Z","shell.execute_reply":"2022-10-04T14:34:08.675808Z","shell.execute_reply.started":"2022-10-04T14:34:08.574656Z"},"trusted":true},"outputs":[],"source":["from sklearn.preprocessing import OneHotEncoder\n","onehotencoder = OneHotEncoder()\n","X_cat = onehotencoder.fit_transform(X_cat).toarray()\n","X_cat"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:34:31.812572Z","iopub.status.busy":"2022-10-04T14:34:31.811948Z","iopub.status.idle":"2022-10-04T14:34:31.821379Z","shell.execute_reply":"2022-10-04T14:34:31.819904Z","shell.execute_reply.started":"2022-10-04T14:34:31.812529Z"},"trusted":true},"outputs":[],"source":["X_cat.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:35:00.407102Z","iopub.status.busy":"2022-10-04T14:35:00.40662Z","iopub.status.idle":"2022-10-04T14:35:00.413423Z","shell.execute_reply":"2022-10-04T14:35:00.412131Z","shell.execute_reply.started":"2022-10-04T14:35:00.407069Z"},"trusted":true},"outputs":[],"source":["X_cat = pd.DataFrame(X_cat)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:35:12.894952Z","iopub.status.busy":"2022-10-04T14:35:12.894514Z","iopub.status.idle":"2022-10-04T14:35:12.903416Z","shell.execute_reply":"2022-10-04T14:35:12.901817Z","shell.execute_reply.started":"2022-10-04T14:35:12.894917Z"},"trusted":true},"outputs":[],"source":["X_numerical = employee[['Age','DailyRate','DistanceFromHome','Education','EnvironmentSatisfaction','HourlyRate','JobInvolvement','JobLevel','JobSatisfaction','MonthlyIncome','MonthlyRate','NumCompaniesWorked','OverTime','PercentSalaryHike','PerformanceRating','RelationshipSatisfaction','StockOptionLevel','TotalWorkingYears','TrainingTimesLastYear','WorkLifeBalance','YearsAtCompany','YearsInCurrentRole','YearsSinceLastPromotion','YearsWithCurrManager']]"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:35:33.305497Z","iopub.status.busy":"2022-10-04T14:35:33.305042Z","iopub.status.idle":"2022-10-04T14:35:33.336169Z","shell.execute_reply":"2022-10-04T14:35:33.335296Z","shell.execute_reply.started":"2022-10-04T14:35:33.305461Z"},"trusted":true},"outputs":[],"source":["X_all = pd.concat([X_cat, X_numerical], axis = 1)\n","X_all.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:35:53.649953Z","iopub.status.busy":"2022-10-04T14:35:53.649491Z","iopub.status.idle":"2022-10-04T14:35:53.670002Z","shell.execute_reply":"2022-10-04T14:35:53.668627Z","shell.execute_reply.started":"2022-10-04T14:35:53.649919Z"},"trusted":true},"outputs":[],"source":["from sklearn.preprocessing import MinMaxScaler\n","scaler = MinMaxScaler()\n","X = scaler.fit_transform(X_all)\n","X"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:36:09.265923Z","iopub.status.busy":"2022-10-04T14:36:09.265416Z","iopub.status.idle":"2022-10-04T14:36:09.277362Z","shell.execute_reply":"2022-10-04T14:36:09.275375Z","shell.execute_reply.started":"2022-10-04T14:36:09.265884Z"},"trusted":true},"outputs":[],"source":["y = employee['Attrition']\n","y"]},{"cell_type":"markdown","metadata":{},"source":["# **Train and Evaluate Logistic Regression Classifier**"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:37:21.565868Z","iopub.status.busy":"2022-10-04T14:37:21.56531Z","iopub.status.idle":"2022-10-04T14:37:21.644749Z","shell.execute_reply":"2022-10-04T14:37:21.643455Z","shell.execute_reply.started":"2022-10-04T14:37:21.565829Z"},"trusted":true},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:37:36.643977Z","iopub.status.busy":"2022-10-04T14:37:36.64338Z","iopub.status.idle":"2022-10-04T14:37:36.654642Z","shell.execute_reply":"2022-10-04T14:37:36.653079Z","shell.execute_reply.started":"2022-10-04T14:37:36.64393Z"},"trusted":true},"outputs":[],"source":["X_train.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:37:45.247651Z","iopub.status.busy":"2022-10-04T14:37:45.247164Z","iopub.status.idle":"2022-10-04T14:37:45.256076Z","shell.execute_reply":"2022-10-04T14:37:45.254793Z","shell.execute_reply.started":"2022-10-04T14:37:45.247612Z"},"trusted":true},"outputs":[],"source":["X_test.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:37:57.587953Z","iopub.status.busy":"2022-10-04T14:37:57.587483Z","iopub.status.idle":"2022-10-04T14:37:57.673281Z","shell.execute_reply":"2022-10-04T14:37:57.671764Z","shell.execute_reply.started":"2022-10-04T14:37:57.587917Z"},"trusted":true},"outputs":[],"source":["from sklearn.linear_model import LogisticRegression\n","from sklearn.metrics import accuracy_score"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:38:10.211122Z","iopub.status.busy":"2022-10-04T14:38:10.210663Z","iopub.status.idle":"2022-10-04T14:38:10.275464Z","shell.execute_reply":"2022-10-04T14:38:10.274001Z","shell.execute_reply.started":"2022-10-04T14:38:10.211085Z"},"trusted":true},"outputs":[],"source":["model = LogisticRegression()\n","model.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:38:19.494602Z","iopub.status.busy":"2022-10-04T14:38:19.494114Z","iopub.status.idle":"2022-10-04T14:38:19.502736Z","shell.execute_reply":"2022-10-04T14:38:19.50105Z","shell.execute_reply.started":"2022-10-04T14:38:19.494563Z"},"trusted":true},"outputs":[],"source":["y_pred = model.predict(X_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:38:31.989936Z","iopub.status.busy":"2022-10-04T14:38:31.989516Z","iopub.status.idle":"2022-10-04T14:38:31.998928Z","shell.execute_reply":"2022-10-04T14:38:31.997678Z","shell.execute_reply.started":"2022-10-04T14:38:31.989904Z"},"trusted":true},"outputs":[],"source":["y_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:38:48.757299Z","iopub.status.busy":"2022-10-04T14:38:48.75682Z","iopub.status.idle":"2022-10-04T14:38:48.76601Z","shell.execute_reply":"2022-10-04T14:38:48.764461Z","shell.execute_reply.started":"2022-10-04T14:38:48.757259Z"},"trusted":true},"outputs":[],"source":["from sklearn.metrics import confusion_matrix, classification_report\n","print('Accuracy {} %'.format( 100 * accuracy_score(y_pred, y_test)))"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:39:01.717894Z","iopub.status.busy":"2022-10-04T14:39:01.717242Z","iopub.status.idle":"2022-10-04T14:39:01.994216Z","shell.execute_reply":"2022-10-04T14:39:01.992843Z","shell.execute_reply.started":"2022-10-04T14:39:01.717844Z"},"trusted":true},"outputs":[],"source":["cm = confusion_matrix(y_pred, y_test)\n","sns.heatmap(cm, annot = True)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:39:19.011226Z","iopub.status.busy":"2022-10-04T14:39:19.010471Z","iopub.status.idle":"2022-10-04T14:39:19.026857Z","shell.execute_reply":"2022-10-04T14:39:19.025413Z","shell.execute_reply.started":"2022-10-04T14:39:19.011172Z"},"trusted":true},"outputs":[],"source":["print(classification_report(y_test, y_pred))"]},{"cell_type":"markdown","metadata":{},"source":["# **Train and Evaluate A Random Forest Classifier**"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:40:14.500287Z","iopub.status.busy":"2022-10-04T14:40:14.499796Z","iopub.status.idle":"2022-10-04T14:40:15.008718Z","shell.execute_reply":"2022-10-04T14:40:15.006678Z","shell.execute_reply.started":"2022-10-04T14:40:14.500249Z"},"trusted":true},"outputs":[],"source":["from sklearn.ensemble import RandomForestClassifier\n","model = RandomForestClassifier()\n","model.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:40:27.799052Z","iopub.status.busy":"2022-10-04T14:40:27.798622Z","iopub.status.idle":"2022-10-04T14:40:27.829506Z","shell.execute_reply":"2022-10-04T14:40:27.828449Z","shell.execute_reply.started":"2022-10-04T14:40:27.79902Z"},"trusted":true},"outputs":[],"source":["y_pred = model.predict(X_test)\n","y_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:40:41.718991Z","iopub.status.busy":"2022-10-04T14:40:41.718539Z","iopub.status.idle":"2022-10-04T14:40:41.985964Z","shell.execute_reply":"2022-10-04T14:40:41.984494Z","shell.execute_reply.started":"2022-10-04T14:40:41.718958Z"},"trusted":true},"outputs":[],"source":["cm = confusion_matrix(y_pred, y_test)\n","sns.heatmap(cm, annot = True)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:40:58.066417Z","iopub.status.busy":"2022-10-04T14:40:58.065602Z","iopub.status.idle":"2022-10-04T14:40:58.080161Z","shell.execute_reply":"2022-10-04T14:40:58.078731Z","shell.execute_reply.started":"2022-10-04T14:40:58.066367Z"},"trusted":true},"outputs":[],"source":["print(classification_report(y_test, y_pred))"]},{"cell_type":"markdown","metadata":{},"source":["# **TRAIN AND EVALUATE A DEEP LEARNING MODEL**"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:42:14.185047Z","iopub.status.busy":"2022-10-04T14:42:14.18382Z","iopub.status.idle":"2022-10-04T14:42:21.544952Z","shell.execute_reply":"2022-10-04T14:42:21.543487Z","shell.execute_reply.started":"2022-10-04T14:42:14.184996Z"},"trusted":true},"outputs":[],"source":["import tensorflow as tf\n","\n","model = tf.keras.models.Sequential()\n","model.add(tf.keras.layers.Dense(units = 500, activation = 'relu', input_shape = (50, )))\n","model.add(tf.keras.layers.Dense(units = 500, activation = 'relu'))\n","model.add(tf.keras.layers.Dense(units = 500, activation = 'relu'))\n","model.add(tf.keras.layers.Dense(units = 1, activation = 'sigmoid'))"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:42:32.235935Z","iopub.status.busy":"2022-10-04T14:42:32.23547Z","iopub.status.idle":"2022-10-04T14:42:32.24369Z","shell.execute_reply":"2022-10-04T14:42:32.242395Z","shell.execute_reply.started":"2022-10-04T14:42:32.235898Z"},"trusted":true},"outputs":[],"source":["model.summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:43:10.052082Z","iopub.status.busy":"2022-10-04T14:43:10.051284Z","iopub.status.idle":"2022-10-04T14:43:31.404679Z","shell.execute_reply":"2022-10-04T14:43:31.403244Z","shell.execute_reply.started":"2022-10-04T14:43:10.052024Z"},"trusted":true},"outputs":[],"source":["model.compile(optimizer = 'Adam', loss = 'binary_crossentropy', metrics = ['accuracy'])\n","epochs_hist = model.fit(X_train, y_train, epochs = 100, batch_size = 50)"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:44:11.431822Z","iopub.status.busy":"2022-10-04T14:44:11.431356Z","iopub.status.idle":"2022-10-04T14:44:11.61021Z","shell.execute_reply":"2022-10-04T14:44:11.608873Z","shell.execute_reply.started":"2022-10-04T14:44:11.431786Z"},"trusted":true},"outputs":[],"source":["y_pred = model.predict(X_test)\n","y_pred = (y_pred>0.5)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:44:16.065134Z","iopub.status.busy":"2022-10-04T14:44:16.064126Z","iopub.status.idle":"2022-10-04T14:44:16.078646Z","shell.execute_reply":"2022-10-04T14:44:16.077233Z","shell.execute_reply.started":"2022-10-04T14:44:16.065078Z"},"trusted":true},"outputs":[],"source":["y_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:44:38.179785Z","iopub.status.busy":"2022-10-04T14:44:38.178625Z","iopub.status.idle":"2022-10-04T14:44:38.406976Z","shell.execute_reply":"2022-10-04T14:44:38.405719Z","shell.execute_reply.started":"2022-10-04T14:44:38.179738Z"},"trusted":true},"outputs":[],"source":["plt.plot(epochs_hist.history['loss'])\n","plt.title(\"Model Loss Progress During Traing\")\n","plt.xlabel(\"Epoch\")\n","plt.ylabel(\"Training Loss\")\n","plt.legend([\"Training Loss\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:44:58.065938Z","iopub.status.busy":"2022-10-04T14:44:58.065478Z","iopub.status.idle":"2022-10-04T14:44:58.307649Z","shell.execute_reply":"2022-10-04T14:44:58.306225Z","shell.execute_reply.started":"2022-10-04T14:44:58.0659Z"},"trusted":true},"outputs":[],"source":["plt.plot(epochs_hist.history['accuracy'])\n","plt.title(\"Model Accuracy Progress During Traing\")\n","plt.xlabel(\"Epoch\")\n","plt.ylabel(\"Training Accuracy\")\n","plt.legend([\"Training Accuracy\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:45:15.265393Z","iopub.status.busy":"2022-10-04T14:45:15.264903Z","iopub.status.idle":"2022-10-04T14:45:15.503732Z","shell.execute_reply":"2022-10-04T14:45:15.502486Z","shell.execute_reply.started":"2022-10-04T14:45:15.265347Z"},"trusted":true},"outputs":[],"source":["cm = confusion_matrix(y_test, y_pred)\n","sns.heatmap(cm, annot = True)"]},{"cell_type":"code","execution_count":null,"metadata":{"execution":{"iopub.execute_input":"2022-10-04T14:45:49.133981Z","iopub.status.busy":"2022-10-04T14:45:49.133484Z","iopub.status.idle":"2022-10-04T14:45:49.145727Z","shell.execute_reply":"2022-10-04T14:45:49.144279Z","shell.execute_reply.started":"2022-10-04T14:45:49.133942Z"},"trusted":true},"outputs":[],"source":["print(classification_report(y_test, y_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.4"}},"nbformat":4,"nbformat_minor":4}
